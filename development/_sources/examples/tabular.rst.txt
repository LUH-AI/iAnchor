
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/tabular.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_tabular.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_tabular.py:


Tabular Explanation
-------------------

An example how to use iAnchor for tabular data.

.. GENERATED FROM PYTHON SOURCE LINES 7-58

.. code-block:: default


    import numpy as np
    import sklearn
    import sklearn.ensemble
    from ianchor.anchor import Anchor
    from ianchor.samplers import Tasktype


    if __name__ == "__main__":
        # Get data
        data = np.genfromtxt("datasets/titanic.txt", delimiter=",")
        y_train = data[:, -1]
        X_train = data[:, :-1]

        # Train model
        c = sklearn.ensemble.RandomForestClassifier(n_estimators=100, n_jobs=5, random_state=123)
        c.fit(X_train, y_train)
        print("Train accuracy:", sklearn.metrics.accuracy_score(y_train, c.predict(X_train)))

        # Create explainer
        explainer = Anchor(Tasktype.TABULAR)
        task_paras = {
            "dataset": X_train,
            "column_names": [
                "PcClass",
                "Name",
                "Sex",
                "Age",
                "SibSp",
                "Parch",
                "Ticket",
                "Fare",
                "Cabin",
                "Embarked",
            ],
        }
        method_paras = {"beam_size": 1, "desired_confidence": 1.0}

        # Explain instance
        anchor = explainer.explain_instance(
            input=X_train[759].reshape(1, -1),
            predict_fn=c.predict,
            method="beam",
            task_specific=task_paras,
            method_specific=method_paras,
            num_coverage_samples=100,
        )

        # Visualize explanation
        v = explainer.visualize(anchor, X_train[759])
        print(v)


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.000 seconds)


.. _sphx_glr_download_examples_tabular.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: tabular.py <tabular.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: tabular.ipynb <tabular.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
